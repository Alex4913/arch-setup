#!/bin/bash
# configure
# aoneill - 09/25/15

export CWD="$PWD"
export SUPPORT="$CWD/support"
source "$SUPPORT/globals"

function pre-setup() {
  cd $SUPPORT
  for file in $(find . -maxdepth 1 -type f | sort)
  do
    if [[ -x "$file" ]]
    then
      "$file"
    fi
  done
  cd $CWD
}

function prog-setup() {
  cd $PROGS
  for file in $(find . -maxdepth 1 -type f | sort)
  do
    if [[ -x "$file" ]]
    then
      "$file" "$SUPPORT" "$SUPPORT/globals"
    fi
  done
  cd $CWD
}

function init() {
  # Need root-level permissions (assuming no sudo)
  if [[ "$(whoami)" != "root" ]]
  then
    echo "Need root-level access. Run as root!"
    exit
  fi

  section "Alex O'Neill's Arch Customizer"  

  echo -e "\
This is intended to configure a vanilla installation of Arch Linux to be
as close to the working copy I run on my various computers. See the README
for more information!\n"

  pre-setup
  prog-setup

  echo reboot
}

init $@
